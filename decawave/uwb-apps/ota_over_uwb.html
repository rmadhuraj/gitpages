

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    

    
    <title>UWB OTA &mdash; Apache Mynewt latest documentation</title>
    

    
    
      <link rel="shortcut icon" href="../../_static/mynewt-logo-only-newt32x32.png"/>
    

    

    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

    
      <link rel="stylesheet" href="../../_static/css/sphinx_theme.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/bootstrap-3.0.3.min.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/v2.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/restructuredtext.css" type="text/css" />
    

    

    <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />
          <link rel="index" title="Index"
                href="../../genindex.html"/>
          <link rel="search" title="Search" href="../../search.html"/>
      <link rel="top" title="Apache Mynewt latest documentation" href="../../index.html"/>
          <link rel="up" title="UWB-APPS" href="uwb-apps.html"/>
          <link rel="next" title="rtdoa" href="rtdoa.html"/>
          <link rel="prev" title="lwip_ping" href="lwip_ping.html"/> 

    
    <script src="../../_static/js/modernizr.min.js"></script>

    
    <script>
    (function(i, s, o, g, r, a, m) {
	i["GoogleAnalyticsObject"] = r;
	(i[r] =
		i[r] ||
		function() {
			(i[r].q = i[r].q || []).push(arguments);
		}),
		(i[r].l = 1 * new Date());
	(a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
	a.async = 1;
	a.src = g;
	m.parentNode.insertBefore(a, m);
})(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");

ga("create", "UA-72162311-1", "auto");
ga("send", "pageview");
</script>
    

  </head>

  <body class="not-front page-documentation" role="document" >
    <div id="wrapper">
      <div class="container">
    <div id="banner" class="row v2-main-banner">
        <a class="logo-cell" href="/">
            <img class="logo" src="../../_static/img/logo.png">
        </a>
        <div class="tagline-cell">
            <h4 class="tagline">An OS to build, deploy and securely manage billions of devices</h4>
        </div>
        <div class="news-cell">
            <div class="well">
                <h4>Latest News:</h4> <a href="/download">Apache Mynewt 1.7.0, Apache NimBLE 1.2.0 </a> released (August 4, 2019)
            </div>
        </div>
    </div>
</div>
      
<header>
    <nav id="navbar" class="navbar navbar-inverse" role="navigation">
        <div class="container">
            <!-- Collapsed navigation -->
            <div class="navbar-header">
                <!-- Expander button -->
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

            </div>

            <!-- Expanded navigation -->
            <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/"><i class="fa fa-home" style="font-size: larger;"></i></a>
                    </li>
                    <li class="important">
                        <a href="/quick-start/">Quick Start</a>
                    </li>
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    <li>
                        <a href="/talks/">Talks</a>
                    </li>
                    <li class="active">
                        <a href="/documentation/">Documentation</a>
                    </li>
                    <li>
                        <a href="/download/">Download</a>
                    </li>
                    <li>
                        <a href="/community/">Community</a>
                    </li>
                    <li>
                        <a href="/events/">Events</a>
                    </li>
                </ul>

                <!-- Search, Navigation and Repo links -->
                <ul class="nav navbar-nav navbar-right">
                    
                </ul>
            </div>
        </div>
    </nav>
</header>
      <!-- STARTS MAIN CONTENT -->
      <div id="main-content">
        





<div id="breadcrumb">
  <div class="container">
    <a href="/documentation/">Docs</a> /
    
      <a href="../decawave.html">Decawave-UWB User Guide</a> /
    
      <a href="uwb-apps.html">UWB-APPS</a> /
    
    UWB OTA
    
  <div class="sourcelink">
    <a href="https://github.com/apache/mynewt-documentation/edit/master/docs/decawave/uwb-apps/ota_over_uwb.rst" class="icon icon-github"
           rel="nofollow"> Edit on GitHub</a>
</div>
  </div>
</div>
        <!-- STARTS CONTAINER -->
        <div class="container">
          <!-- STARTS .content -->
          <div id="content" class="row">
            
            <!-- STARTS .container-sidebar -->
<div class="container-sidebar col-xs-12 col-sm-3">
  <div id="docSidebar" class="sticky-container">
    <div role="search" class="sphinx-search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search documentation" class="search-documentation" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    <!-- Note: only works when deployed -->
<select class="form-control" onchange="if (this.value) window.location.href=this.value">
  <option value="/latest" selected>
    Version: latest
  </option>
  <option value="/v1_7_0" >
    Version: 1.7.0
  </option>
  <option value="/v1_6_0" >
    Version: 1.6.0
  </option>
  <option value="/v1_5_0" >
    Version: 1.5.0
  </option>
  <option value="/v1_4_0" >
    Version: 1.4.0
  </option>
  <option value="/v1_3_0/os/introduction" >
    Version: 1.3.0
  </option>
  <option value="/v1_2_0/os/introduction" >
    Version: 1.2.0
  </option>
  <option value="/v1_1_0/os/introduction" >
    Version: 1.1.0
  </option>
  <option value="/v1_0_0/os/introduction" >
    Version: 1.0.0
  </option>
  <option value="/v0_9_0/os/introduction" >
    Version: 0.9.0
  </option>
</select>
    <div class="region region-sidebar">
      <div class="docs-menu">
      
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../decawave.html">Decawave-UWB User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uwb-core/uwb-core.html">uwb-core</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="uwb-apps.html">uwb-apps</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="twr_aloha.html">twr_aloha</a></li>
<li class="toctree-l3"><a class="reference internal" href="twr_tdma.html">twr_tdma</a></li>
<li class="toctree-l3"><a class="reference internal" href="twr_nranges_tdma.html">twr_nranges_tdma</a></li>
<li class="toctree-l3"><a class="reference internal" href="lwip_ping.html">lwip_ping</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ota_over_uwb</a></li>
<li class="toctree-l3"><a class="reference internal" href="rtdoa.html">rtdoa</a></li>
<li class="toctree-l3"><a class="reference internal" href="openthread.html">openthread</a></li>
<li class="toctree-l3"><a class="reference internal" href="listener.html">listener</a></li>
<li class="toctree-l3"><a class="reference internal" href="loopback.html">loopback</a></li>
<li class="toctree-l3"><a class="reference internal" href="matlab.html">matlab</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        
      
      </div>
    </div>
  </div>
  <!-- ENDS STICKY CONTAINER -->
</div>
<!-- ENDS .container-sidebar -->

            <div class="col-xs-12 col-sm-9">
              

              
              <div class="">
                <div class="rst-content">
                  <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                   <div itemprop="articleBody">
                    
  <div class="section" id="uwb-ota">
<h1>UWB OTA<a class="headerlink" href="#uwb-ota" title="Permalink to this headline">¶</a></h1>
<div class="section" id="decawave-ota-over-ble-example">
<h2>Decawave OTA over BLE Example<a class="headerlink" href="#decawave-ota-over-ble-example" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The ota_uwb_master &amp; ota_uwb_slave are simple examples that facilitates the image upgrade over air using UWB with a CLI.
To run the below applications which are configured with UART, change the pins in hw/bsp/dwm1001/syscfg.yml.</p>
<ol class="arabic simple">
<li>To erase the default flash image that shipped with the DWM1001 boards.</li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> JLinkExe -device nRF52 -speed <span class="m">4000</span> -if SWD
<span class="go">J-Link&gt;erase</span>
<span class="go">J-Link&gt;exit</span>
<span class="gp">$</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>On 1st dwm1001-dev board build the ota_uwb_master applications for the DWM1001 module.</li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newt target create master</span>
<span class="go">newt target set master app=apps/ota_uwb_master</span>
<span class="go">newt target set master bsp=@decawave-uwb-core/hw/bsp/dwm1001</span>
<span class="go">newt target set master build_profile=optimized</span>
<span class="go">newt target amend master syscfg=&quot;LOG_LEVEL=1&quot;</span>
<span class="go">newt build master</span>
<span class="go">newt create-image master 1.0.0</span>
<span class="go">newt load master</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>On 2nd dwm1001-dev board build the ota_uwb_slave applications for the DWM1001 module.</li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newt target create slave</span>
<span class="go">newt target set slave app=apps/ota_uwb_slave</span>
<span class="go">newt target set slave bsp=@decawave-uwb-core/hw/bsp/dwm1001</span>
<span class="go">newt target set slave build_profile=optimized</span>
<span class="go">newt target amend slave syscfg=&quot;LOG_LEVEL=1&quot;</span>
<span class="go">newt build slave</span>
<span class="go">newt create-image slave 1.0.0</span>
<span class="go">newt load slave</span>
</pre></div>
</div>
<div class="section" id="how-to-test">
<h3>How to test<a class="headerlink" href="#how-to-test" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Upload the image that needs to be sent to slave node using BLE to the master node</li>
</ol>
</div>
<div class="section" id="create-a-newtmgr-connection-profile">
<h3>Create a newtmgr connection profile<a class="headerlink" href="#create-a-newtmgr-connection-profile" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newtmgr conn add ble type=ble connstring=&quot;peer_name=DECA-4321&quot;   (ota_uwb_master)</span>
</pre></div>
</div>
</div>
<div class="section" id="check-whether-newtmgr-can-communicate-and-check-image-status-of-the-device">
<h3>check whether newtmgr can communicate and check image status of the device<a class="headerlink" href="#check-whether-newtmgr-can-communicate-and-check-image-status-of-the-device" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newtmgr image list -c ble</span>
</pre></div>
</div>
<p>With the above command, you get the image slots of the device</p>
</div>
<div class="section" id="create-a-the-image-of-interest">
<h3>Create a the image of interest<a class="headerlink" href="#create-a-the-image-of-interest" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newt create-image slave 2.0.0</span>
</pre></div>
</div>
</div>
<div class="section" id="uploading-an-image-to-device">
<h3>Uploading an image to device<a class="headerlink" href="#uploading-an-image-to-device" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newtmgr image upload -c ble /path of the image created in bin file/</span>
</pre></div>
</div>
</div>
<div class="section" id="check-for-image-status">
<h3>check for image status<a class="headerlink" href="#check-for-image-status" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">newtmgr image list -c ble</span>
</pre></div>
</div>
<p>Now, you get status of primary and secondary slots with 2 different versioned images.</p>
<p>2. Once the required image has been uploaded in the second slot start the upload of this image to slave node
check whether master can talk to slave
<code class="docutils literal notranslate"><span class="pre">```````````````````````````````````</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">img_list 0x1234 (Slave node address)</span>
<span class="go">Should get some logs like this</span>
<span class="go">slot = 0</span>
<span class="go">Version = 0.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : active confirmed</span>
<span class="go">7b6af13ca48f82fe22e009393779a3100458c2dc99e4e86ea38922c0aec5380a</span>
</pre></div>
</div>
<p>With the above commands, you get the image slots of both the devices.</p>
</div>
<div class="section" id="id1">
<h3>Uploading an image to device<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">img_upload slot2 0x1234 (Slave node address)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>check for image status<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">img_list 0x1234 (Slave node address)</span>
<span class="go">Should get some logs like this</span>
<span class="go">Slot = 0</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : active confirmed</span>
<span class="go">6479df5a957bf7fa2e9b45e075788fd91e3fb15895affee06ff3b9cb4e546645</span>

<span class="go">Slot = 1</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags :</span>
<span class="go">76609ae104fd47f74413d1c39501569605a12c2d17f17922cc3e417448244ab7</span>
</pre></div>
</div>
<p>Now, you get status of primary and secondary slots with 2 different versioned images.</p>
</div>
<div class="section" id="test-the-image">
<h3>Test the image<a class="headerlink" href="#test-the-image" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">img_set_state test 76609ae104fd47f74413d1c39501569605a12c2d17f17922cc3e417448244ab7(32 byte hash of testing image) 0x1234(Slave node address)</span>
<span class="go">Should get some logs like this</span>
<span class="go">Slot = 0</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : active confirmed</span>
<span class="go">6479df5a957bf7fa2e9b45e075788fd91e3fb15895affee06ff3b9cb4e546645</span>

<span class="go">Slot = 1</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : pending</span>
<span class="go">76609ae104fd47f74413d1c39501569605a12c2d17f17922cc3e417448244ab7</span>
</pre></div>
</div>
<p>Now the images of secondary slot goes to pending state.</p>
<p><strong>NOTE:</strong> Then power OFF and ON the slave node.</p>
</div>
<div class="section" id="once-the-device-boots-up-check-for-image-status">
<h3>Once the device boots up Check for image status<a class="headerlink" href="#once-the-device-boots-up-check-for-image-status" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">img_list 0x1234 (Slave node address)</span>
<span class="go">Slot = 0</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : active</span>
<span class="go">76609ae104fd47f74413d1c39501569605a12c2d17f17922cc3e417448244ab7</span>

<span class="go">Slot = 1</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : confirmed</span>
<span class="go">6479df5a957bf7fa2e9b45e075788fd91e3fb15895affee06ff3b9cb4e546645</span>
</pre></div>
</div>
<p>After this, the uploaded image becomes active and will be running in primary slot.</p>
</div>
<div class="section" id="confirming-the-image">
<h3>Confirming the image<a class="headerlink" href="#confirming-the-image" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">img_set_state confirm 0x1234 (Slave node address)</span>
</pre></div>
</div>
<p>Should get some logs like this</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Slot = 0</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags : active confirmed</span>
<span class="go">76609ae104fd47f74413d1c39501569605a12c2d17f17922cc3e417448244ab7</span>

<span class="go">Slot = 1</span>
<span class="go">Version = 1.0.0</span>
<span class="go">bootable : true</span>
<span class="go">Flags :</span>
<span class="go">6479df5a957bf7fa2e9b45e075788fd91e3fb15895affee06ff3b9cb4e546645</span>
</pre></div>
</div>
</div>
</div>
</div>


                   </div>
                  </div>
                  
    <div class="rst-footer-buttons row" role="navigation" aria-label="footer navigation">
      
        <a href="rtdoa.html" class="btn btn-neutral float-right" title="rtdoa" accesskey="n">Next: rtdoa <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lwip_ping.html" class="btn btn-neutral" title="lwip_ping" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous: lwip_ping</a>
      
    </div>

                </div>
              </div>
            </div>
            <!-- ENDS CONTENT SECTION -->
          </div>
          <!-- ENDS .content -->
        </div>
      </div>
      <footer>
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
          
              <p class="copyright">Apache Mynewt is available under Apache License, version 2.0.</p>
          
      </div>
      <div class="col-xs-12">
          <div class="logos">
              <img src="../../_static/img/asf_logo_wide_small.png" alt="Apache" title="Apache">
              <small class="footnote">
                Apache Mynewt, Mynewt, Apache, the Apache feather logo, and the Apache Mynewt project logo are either
                registered trademarks or trademarks of the Apache Software Foundation in the United States and other countries.
              </small>
              <a href="">
                <img src="../../_static/img/add_to_slack.png" alt="Slack Icon" title="Join our Slack Community" />
              </a>
          </div>
      </div>
    </div>
  </div>
</footer>
    </div>
    <!-- ENDS #wrapper -->

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'latest',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/language_data.js"></script>
      <script type="text/javascript" src="../../_static/js/bootstrap-3.0.3.min.js"></script>
      <script type="text/javascript" src="../../_static/js/affix.js"></script>
      <script type="text/javascript" src="../../_static/js/main.js"></script>

   

  </body>
</html>